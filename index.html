<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --uk-red: #ff3333;
            --uk-green: #00ff00;
            --uk-white: #ffffff;
        }

        body { 
            background: #000; color: var(--uk-white); 
            font-family: 'Share Tech Mono', monospace; 
            margin: 0; padding: 25px;
            text-transform: uppercase;
            overflow-x: hidden;
        }

        /* CRT Scanlines */
        body::before {
            content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            z-index: 10; background-size: 100% 3px; pointer-events: none;
        }

        .line { min-height: 1.2em; margin-bottom: 5px; white-space: pre-wrap; }
        .green { color: var(--uk-green); }
        .red { color: var(--uk-red); }

        /* Cursor Effect */
        .cursor::after {
            content: "_";
            animation: blink 0.5s step-end infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        input { 
            background: transparent; border: none; border-left: 2px solid var(--uk-white);
            color: var(--uk-white); width: 90%; padding: 10px; margin: 10px 0;
            font-family: inherit; outline: none; display: none;
        }

        button { 
            display: none; background: transparent; color: var(--uk-green); 
            border: 1px solid var(--uk-green); padding: 10px; cursor: pointer; 
            font-family: inherit; margin-top: 20px; width: 100%;
        }
        button:active { background: var(--uk-green); color: #000; }
    </style>
</head>
<body>
    <div id="terminal"></div>
    <form id="form">
        <input type="text" id="name" placeholder="> MACHINE_ID">
        <input type="number" id="age" placeholder="> CYCLES">
        <input type="text" id="phone" placeholder="> COMM_LINK">
        <input type="email" id="email" placeholder="> DIGITAL_SIG">
        <button type="button" id="subBtn" onclick="submitData()">FINALIZE CALIBRATION</button>
    </form>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        const terminal = document.getElementById('terminal');
        const script = [
            { text: "BOOT UP SEQUENCE READY", class: "" },
            { text: "FIRMWARE LATEST VERSION (2112.08.06)", class: "green" },
            { text: "CALIBRATION: EXPIRED", class: "red" },
            { text: "NEW CALIBRATION REQUIRED", class: "red" },
            { text: " ", class: "" },
            { text: "BEGINNING CALIBRATION...", class: "" },
            { text: "AUDIO ............ OK", class: "green" },
            { text: "VIDEO ............ OK", class: "green" },
            { text: "MECHANICS ........ OK", class: "green" },
            { text: " ", class: "" },
            { text: "PRIMARY SETTINGS UPDATED", class: "green" },
            { text: "IDENTIFY MACHINE ID:", class: "" }
        ];

        async function typeWriter(lineObj) {
            const div = document.createElement('div');
            div.className = 'line ' + lineObj.class + ' cursor';
            terminal.appendChild(div);

            for (let char of lineObj.text) {
                div.textContent += char;
                await new Promise(r => setTimeout(r, 30)); // Speed of typing
            }
            div.classList.remove('cursor');
        }

        async function runBoot() {
            for (let line of script) {
                await typeWriter(line);
                await new Promise(r => setTimeout(r, 200)); // Delay between lines
            }
            // Show the inputs
            document.querySelectorAll('input').forEach(i => i.style.display = 'block');
            document.getElementById('subBtn').style.display = 'block';
        }

        function submitData() {
            const data = {
                name: document.getElementById('name').value,
                age: document.getElementById('age').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value
            };
            if(!data.name || !data.phone) return;
            tg.sendData(JSON.stringify(data));
        }

        window.onload = runBoot;
    </script>
</body>
</html>
